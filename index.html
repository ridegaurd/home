<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live Screen Broadcast</title>
<style>
body { font-family:sans-serif; background:#111; color:#fff; text-align:center; padding:20px;}
video { width:80%; border:2px solid #0f0; margin:20px auto; display:block;}
h2 { color:#0f0; }
button { padding:10px 20px; font-size:16px; margin:10px; }
</style>
</head>
<body>
<h2>Live Screen Broadcast</h2>
<button id="startBtn">Start Broadcasting</button>
<video id="local" autoplay muted></video>
<video id="remote" autoplay></video>

<script src="https://unpkg.com/simple-peer@9.12.0/simplepeer.min.js"></script>
<script>
let peer;
const localVideo = document.getElementById('local');
const remoteVideo = document.getElementById('remote');
const startBtn = document.getElementById('startBtn');

// Free cloud signaling using wss://signaling.simple-peerjs.com
const SIGNAL_SERVER = 'wss://signaling.simple-peerjs.com';

startBtn.onclick = async () => {
  startBtn.disabled = true;

  const stream = await navigator.mediaDevices.getDisplayMedia({ video:true, audio:true });
  localVideo.srcObject = stream;

  // Connect to signaling server
  const ws = new WebSocket(SIGNAL_SERVER);

  ws.onopen = () => {
    console.log("Connected to signaling server");
  };

  ws.onmessage = msg => {
    const data = JSON.parse(msg.data);
    if (data.type === 'signal' && peer) peer.signal(data.signal);
  };

  // Create a Simple-Peer
  peer = new SimplePeer({ initiator:true, trickle:false, stream });

  peer.on('signal', signal => ws.send(JSON.stringify({ type:'signal', signal })));
  peer.on('stream', remoteStream => {
    remoteVideo.srcObject = remoteStream;
  });

  alert("Your screen is now broadcasting. Anyone opening this page will see it automatically.");
};
</script>
</body>
</html>
